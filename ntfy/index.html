<!DOCTYPE html>
<html>
<head>
    <meta name="title" content="Notificationss Demo :3">
    <meta name="description" content="Silly notification demo :3">
    <meta content="#af6cd6" name="theme-color">
    <link rel="stylesheet" type="text/css" href="cactus-styles.css">
    <link rel="stylesheet" type="text/css" href="/resources/styles.css">
    <link rel="stylesheet" type="text/css" href="styles.css">
    <title>Contact</title>
</head>

<body onload='cactusInit()'>

    
    <!-- modified from https://lilysthings.org/ -->
    <div id="ntfy-container">
        <div class="ntfy-box">
            <h4>send a notification directly to my phone; please be funny.</h4>
            <textarea id="ntfy-input" placeholder="whats up"></textarea>
            <button onclick="sendNotification()" style="margin-left:10px;">Send</button>
        </div>
        <div class="drawing">
            <canvas id="canvas"></canvas>
            <button id="undo" onclick="undo()">â†º</button>
            <input type="color" id="strokeColor" name="strokeColor" value="#8c6ec9"/>
            <input type="number" id="thicc" min="1" max="50" value="5">
            <p>Draw something too :3</p>
        </div>
    </div>
    <script src="draw.js"></script>

    <script type="text/javascript" src="https://latest.cactus.chat/cactus.js"></script>
    <link rel="stylesheet" href="https://latest.cactus.chat/style.css" type="text/css">

    <div id="guestbook-container">
        <h2>Guestbook</h2>
        <div id="comment-section"></div>
        <script>
            initComments({
            node: document.getElementById("comment-section"),
            defaultHomeserverUrl: "https://matrix.cactus.chat:8448",
            serverName: "cactus.chat",
            siteName: "neo.cat-boop.com",
            commentSectionId: "guestbook"
            });
        </script>
    </div>

    <script>
        async function send(message, canvas) {
            let r = new XMLHttpRequest()
            r.open("POST", "https://api.imgbb.com/1/upload?expiration=604800&key=28a982c96954a29ed6abe08f8e375e17", true);

            // Set up what happens when the request successfully completes
            r.onload = function() {
                if (r.status === 200) {
                    // Parse the response
                    let response = JSON.parse(r.responseText);
                    console.log('Image uploaded successfully:', response);
                    sendToNtfy(message, response.data.url);
                    ntfyInput.value = "";
                    ntfyInput.placeholder = "sent :3";
                    clearDraw();
                } else {
                    console.error('Error uploading image:', r.statusText);
                }
            };

            // Set up what happens in case of an error
            r.onerror = function() {
                console.error('Request failed');
            };

            // Create a FormData object to hold the image
            let formData = new FormData();
            base64Image = document.getElementById("canvas").toDataURL();
            formData.append('image', base64Image.split(',')[1]);

            // Send the request with the form data
            r.send(formData);
        }

        // send notification
        const ntfyInput = document.getElementById("ntfy-input");
        function sendNotification() {
            if (ntfyInput.value.length <= 0) return;
            send(ntfyInput.value);
        }

        // both
        function sendToNtfy(message, image) {
            let r = new XMLHttpRequest()
            r.open("POST", "https://ntfy.sh/nic3435", true);
            r.setRequestHeader("Content-Type", "text/plain");
            r.setRequestHeader("Attach", image)
            r.send(message);
        }
    </script>
    <script src="cactusStyleChange.js"></script>
    
</body>

</html> 